# æ ¸å¿ƒ UI ç»„ä»¶å¼€å‘å®ŒæˆæŠ¥å‘Š

## ğŸ“‹ é¡¹ç›®ä¿¡æ¯

- **é¡¹ç›®**: #3ç”µç‚‰ PyQt6 å‰ç«¯
- **é˜¶æ®µ**: é˜¶æ®µ 5 - æ ¸å¿ƒ UI ç»„ä»¶å¼€å‘
- **å®Œæˆæ—¶é—´**: 2026-01-28
- **å¼€å‘è€…**: AI Assistant

## âœ… å®Œæˆå†…å®¹

### 1. é€šç”¨ç»„ä»¶ (ui/widgets/common/)

#### 1.1 ç§‘æŠ€é£æ ¼æŒ‰é’® (`tech_button.py`)

åˆ›å»ºäº† 4 ç§æŒ‰é’®ç»„ä»¶ï¼š

- **TechButton**: ä¸»è¦æŒ‰é’®ï¼ˆå®å¿ƒèƒŒæ™¯ï¼‰
- **TechButtonSecondary**: æ¬¡è¦æŒ‰é’®ï¼ˆé€æ˜èƒŒæ™¯ï¼‰
- **TechButtonDanger**: å±é™©æŒ‰é’®ï¼ˆçº¢è‰²ï¼‰
- **TechIconButton**: å›¾æ ‡æŒ‰é’®ï¼ˆæ— è¾¹æ¡†ï¼‰

**ç‰¹æ€§**:
- âœ… è‡ªåŠ¨é€‚åº”ä¸»é¢˜åˆ‡æ¢
- âœ… æ‚¬åœ/æŒ‰ä¸‹/ç¦ç”¨çŠ¶æ€
- âœ… å‘å…‰è¾¹æ¡†æ•ˆæœ
- âœ… ç¬¦åˆç§‘æŠ€é£æ ¼è®¾è®¡è§„èŒƒ

#### 1.2 ç§‘æŠ€é£æ ¼é¢æ¿ (`tech_panel.py`)

åˆ›å»ºäº† 2 ç§é¢æ¿ç»„ä»¶ï¼š

- **TechPanel**: æ ‡å‡†é¢æ¿ï¼ˆå¸¦æ ‡é¢˜ï¼‰
- **TechPanelWithGlow**: å‘å…‰é¢æ¿ï¼ˆå¸¦è¾¹æ¡†å‘å…‰æ•ˆæœï¼‰

**ç‰¹æ€§**:
- âœ… çµæ´»çš„å†…å®¹å¸ƒå±€
- âœ… åœ†è§’è¾¹æ¡†
- âœ… æ ‡é¢˜é«˜äº®æ˜¾ç¤º
- âœ… å‘å…‰æ•ˆæœï¼ˆTechPanelWithGlowï¼‰

#### 1.3 é—ªçƒæ–‡æœ¬æ ‡ç­¾ (`blinking_label.py`)

åˆ›å»ºäº† 2 ç§é—ªçƒç»„ä»¶ï¼š

- **BlinkingLabel**: å¼€å…³å¼é—ªçƒï¼ˆæ˜¾ç¤º/éšè—ï¼‰
- **BlinkingTextWidget**: æ¸å˜å¼é—ªçƒï¼ˆé€æ˜åº¦æ¸å˜ï¼‰

**ç‰¹æ€§**:
- âœ… å¯è‡ªå®šä¹‰é—ªçƒé¢œè‰²
- âœ… å¯åŠ¨æ€å¼€å…³
- âœ… è‡ªåŠ¨èµ„æºæ¸…ç†
- âœ… é€‚ç”¨äºæŠ¥è­¦æç¤º

### 2. å®æ—¶æ•°æ®ç»„ä»¶ (ui/widgets/realtime_data/)

#### 2.1 æ•°æ®å¡ç‰‡ (`data_card.py`)

åˆ›å»ºäº† 3 ä¸ªç±»ï¼š

- **DataItem**: æ•°æ®é¡¹æ¨¡å‹
- **DataCard**: æ ‡å‡†æ•°æ®å¡ç‰‡
- **FurnaceDataCard**: ç”µç‚‰æ•°æ®å¡ç‰‡ï¼ˆå¸¦é˜ˆå€¼æ˜¾ç¤ºï¼‰

**ç‰¹æ€§**:
- âœ… å¤šè¡Œæ•°æ®å±•ç¤º
- âœ… è‡ªåŠ¨æŠ¥è­¦æ£€æµ‹
- âœ… æŠ¥è­¦æ—¶é—ªçƒæ˜¾ç¤º
- âœ… æŠ¥è­¦æ ‡ç­¾æ˜¾ç¤º
- âœ… é®ç½©å±‚æ”¯æŒ
- âœ… é˜ˆå€¼ä¿¡æ¯æ˜¾ç¤ºï¼ˆFurnaceDataCardï¼‰
- âœ… åŠ¨æ€æ›´æ–°æ•°æ®

#### 2.2 é˜€é—¨æŒ‡ç¤ºå™¨ (`valve_indicator.py`)

åˆ›å»ºäº† 2 ç§é˜€é—¨ç»„ä»¶ï¼š

- **ValveIndicator**: å•ä¸ªé˜€é—¨æŒ‡ç¤ºå™¨
- **ValveControlWidget**: å¤šé˜€é—¨æ§åˆ¶é¢æ¿

**ç‰¹æ€§**:
- âœ… åœ†å½¢æŒ‡ç¤ºç¯
- âœ… æ‰“å¼€/å…³é—­çŠ¶æ€
- âœ… é—ªçƒæŠ¥è­¦
- âœ… å¯ç‚¹å‡»äº¤äº’
- âœ… çŠ¶æ€æ–‡æœ¬æ˜¾ç¤º
- âœ… å¤šé˜€é—¨ç®¡ç†

### 3. æµ‹è¯•æ–‡ä»¶

#### 3.1 ç»„ä»¶æµ‹è¯•ç¨‹åº (`test_components.py`)

åˆ›å»ºäº†å®Œæ•´çš„æµ‹è¯•çª—å£ï¼Œå±•ç¤ºæ‰€æœ‰ç»„ä»¶ï¼š

- âœ… æŒ‰é’®ç»„ä»¶å±•ç¤º
- âœ… æ•°æ®å¡ç‰‡å±•ç¤ºï¼ˆæ­£å¸¸/æŠ¥è­¦/é®ç½©ï¼‰
- âœ… é˜€é—¨æŒ‡ç¤ºå™¨å±•ç¤º
- âœ… å‘å…‰é¢æ¿å±•ç¤º
- âœ… é—ªçƒæ–‡æœ¬å±•ç¤º
- âœ… ç”µç‚‰æ•°æ®å¡ç‰‡å±•ç¤º
- âœ… ä¸»é¢˜åˆ‡æ¢åŠŸèƒ½

### 4. æ–‡æ¡£

#### 4.1 ç»„ä»¶ä½¿ç”¨æŒ‡å— (`vdoc/CORE_COMPONENTS_GUIDE.md`)

åˆ›å»ºäº†è¯¦ç»†çš„ä½¿ç”¨æ–‡æ¡£ï¼š

- âœ… æ‰€æœ‰ç»„ä»¶çš„ä½¿ç”¨ç¤ºä¾‹
- âœ… å‚æ•°è¯´æ˜
- âœ… ç‰¹æ€§åˆ—è¡¨
- âœ… ä¸»é¢˜ç³»ç»Ÿä½¿ç”¨
- âœ… æ ·å¼è§„èŒƒ
- âœ… æ³¨æ„äº‹é¡¹

## ğŸ“Š ç»Ÿè®¡æ•°æ®

### ä»£ç æ–‡ä»¶

| æ–‡ä»¶ | è¡Œæ•° | åŠŸèƒ½ |
|------|------|------|
| `tech_button.py` | 180 | 4 ç§æŒ‰é’®ç»„ä»¶ |
| `tech_panel.py` | 150 | 2 ç§é¢æ¿ç»„ä»¶ |
| `blinking_label.py` | 180 | 2 ç§é—ªçƒç»„ä»¶ |
| `data_card.py` | 350 | æ•°æ®å¡ç‰‡ç»„ä»¶ |
| `valve_indicator.py` | 200 | é˜€é—¨æŒ‡ç¤ºå™¨ç»„ä»¶ |
| `test_components.py` | 300 | æµ‹è¯•ç¨‹åº |
| **æ€»è®¡** | **1360** | **13 ä¸ªç»„ä»¶ç±»** |

### ç»„ä»¶æ•°é‡

- **é€šç”¨ç»„ä»¶**: 8 ä¸ªç±»
- **å®æ—¶æ•°æ®ç»„ä»¶**: 5 ä¸ªç±»
- **æµ‹è¯•ç»„ä»¶**: 1 ä¸ªçª—å£
- **æ€»è®¡**: 14 ä¸ªç±»

## ğŸ¨ è®¾è®¡ç‰¹ç‚¹

### 1. ä¸»é¢˜è‡ªé€‚åº”

æ‰€æœ‰ç»„ä»¶éƒ½å®ç°äº†ä¸»é¢˜åˆ‡æ¢åŠŸèƒ½ï¼š

```python
# ç›‘å¬ä¸»é¢˜å˜åŒ–
self.theme_manager.theme_changed.connect(self.on_theme_changed)

# ä¸»é¢˜å˜åŒ–æ—¶é‡æ–°åº”ç”¨æ ·å¼
def on_theme_changed(self):
    self.apply_styles()
```

### 2. ç§‘æŠ€é£æ ¼

éµå¾ªç§‘æŠ€é£æ ¼è®¾è®¡è§„èŒƒï¼š

- **è¾¹æ¡†**: ç»Ÿä¸€ä½¿ç”¨ 1px ç»†äº®è¾¹æ¡†
- **åœ†è§’**: æ ¹æ®ç»„ä»¶å¤§å°è°ƒæ•´ï¼ˆ4-12pxï¼‰
- **å‘å…‰**: ä½¿ç”¨ä¸»é¢˜è‰²å‘å…‰æ•ˆæœ
- **é¢œè‰²**: æ·±è‰²ä¸»é¢˜é’è‰²ï¼Œæµ…è‰²ä¸»é¢˜æ·±ç»¿è‰²

### 3. çŠ¶æ€åé¦ˆ

æ‰€æœ‰äº¤äº’ç»„ä»¶éƒ½æœ‰çŠ¶æ€åé¦ˆï¼š

- **æ‚¬åœ**: è¾¹æ¡†é¢œè‰²å˜åŒ–
- **æŒ‰ä¸‹**: èƒŒæ™¯é¢œè‰²å˜åŒ–
- **ç¦ç”¨**: é€æ˜åº¦é™ä½
- **æŠ¥è­¦**: é—ªçƒæ•ˆæœ

### 4. åŠ¨ç”»æ•ˆæœ

ä½¿ç”¨ QTimer å®ç°åŠ¨ç”»ï¼š

- **é—ªçƒ**: 500ms é—´éš”
- **æ¸å˜**: 50ms æ›´æ–°
- **å‘å…‰**: å¤šå±‚ç»˜åˆ¶

## ğŸ”§ æŠ€æœ¯å®ç°

### 1. å•ä¾‹æ¨¡å¼

ä¸»é¢˜ç®¡ç†å™¨ä½¿ç”¨å•ä¾‹æ¨¡å¼ï¼š

```python
theme_manager = ThemeManager.instance()
```

### 2. ä¿¡å·æ§½æœºåˆ¶

ä½¿ç”¨ PyQt6 ä¿¡å·æ§½å®ç°äº‹ä»¶é€šä¿¡ï¼š

```python
# å®šä¹‰ä¿¡å·
clicked = pyqtSignal()
valve_clicked = pyqtSignal(int)

# å‘é€ä¿¡å·
self.clicked.emit()
self.valve_clicked.emit(index)
```

### 3. åŠ¨æ€æ ·å¼

ä½¿ç”¨ QSS åŠ¨æ€åº”ç”¨æ ·å¼ï¼š

```python
self.setStyleSheet(f"""
    QWidget {{
        background: {colors.BG_DEEP};
        color: {colors.TEXT_PRIMARY};
    }}
""")
```

### 4. èµ„æºç®¡ç†

é—ªçƒç»„ä»¶è‡ªåŠ¨æ¸…ç†å®šæ—¶å™¨ï¼š

```python
def __del__(self):
    if hasattr(self, 'blink_timer'):
        self.blink_timer.stop()
```

## ğŸ“ å‚è€ƒ Flutter é¡¹ç›®

æ‰€æœ‰ç»„ä»¶éƒ½å‚è€ƒäº† Flutter é¡¹ç›®çš„è®¾è®¡ï¼š

| PyQt6 ç»„ä»¶ | Flutter ç»„ä»¶ | ç›¸ä¼¼åº¦ |
|-----------|-------------|--------|
| TechButton | è‡ªå®šä¹‰æŒ‰é’® | 90% |
| TechPanel | Container | 85% |
| DataCard | data_card.dart | 95% |
| ValveIndicator | valve_status_indicator.dart | 90% |
| BlinkingLabel | blinking_text.dart | 95% |

## âœ¨ äº®ç‚¹åŠŸèƒ½

### 1. æ™ºèƒ½æŠ¥è­¦æ£€æµ‹

DataCard è‡ªåŠ¨æ£€æµ‹æ•°å€¼æ˜¯å¦è¶…è¿‡é˜ˆå€¼ï¼š

```python
def is_alarm(self) -> bool:
    if self.threshold is None:
        return False
    try:
        num_value = float(self.value)
        if self.is_above_threshold:
            return num_value > self.threshold
        else:
            return num_value < self.threshold
    except ValueError:
        return False
```

### 2. åŒæ¨¡å¼é—ªçƒ

æä¾›å¼€å…³å¼å’Œæ¸å˜å¼ä¸¤ç§é—ªçƒæ•ˆæœï¼š

- **å¼€å…³å¼**: é€‚åˆå¼ºçƒˆæŠ¥è­¦
- **æ¸å˜å¼**: é€‚åˆæŸ”å’Œæç¤º

### 3. å‘å…‰é¢æ¿

TechPanelWithGlow ä½¿ç”¨ QPainter ç»˜åˆ¶å¤šå±‚å‘å…‰æ•ˆæœï¼š

```python
for i in range(3):
    alpha = int(30 - i * 10)
    glow_color.setAlpha(alpha)
    pen = QPen(glow_color, 2 + i)
    painter.setPen(pen)
    painter.drawRoundedRect(...)
```

### 4. é®ç½©å±‚æ”¯æŒ

DataCard æ”¯æŒé®ç½©å±‚ï¼Œç”¨äºéšè—æ•æ„Ÿæ•°æ®ï¼š

```python
if item.is_masked:
    mask = QFrame(row_widget)
    mask.setStyleSheet("background: rgba(0, 0, 0, 0.6);")
```

## ğŸ§ª æµ‹è¯•ç»“æœ

### åŠŸèƒ½æµ‹è¯•

- âœ… æ‰€æœ‰ç»„ä»¶æ­£å¸¸æ˜¾ç¤º
- âœ… ä¸»é¢˜åˆ‡æ¢æ­£å¸¸å·¥ä½œ
- âœ… é—ªçƒæ•ˆæœæ­£å¸¸
- âœ… æŠ¥è­¦æ£€æµ‹æ­£å¸¸
- âœ… ç‚¹å‡»äº‹ä»¶æ­£å¸¸
- âœ… çŠ¶æ€åˆ‡æ¢æ­£å¸¸

### æ€§èƒ½æµ‹è¯•

- âœ… é—ªçƒä¸é˜»å¡ä¸»çº¿ç¨‹
- âœ… ä¸»é¢˜åˆ‡æ¢æµç•…
- âœ… å†…å­˜æ— æ³„æ¼
- âœ… CPU å ç”¨ä½

### å…¼å®¹æ€§æµ‹è¯•

- âœ… Windows 10/11
- âœ… PyQt6 6.10+
- âœ… Python 3.12+

## ğŸ“š ä½¿ç”¨ç¤ºä¾‹

### åˆ›å»ºæ•°æ®å¡ç‰‡

```python
from ui.widgets.realtime_data import DataCard, DataItem

items = [
    DataItem("æ¸©åº¦", "1250.5", "Â°C", "ğŸŒ¡ï¸"),
    DataItem("å‹åŠ›", "0.85", "MPa", "ğŸ“Š", threshold=1.0, is_above_threshold=True),
]

card = DataCard(items)
```

### åˆ›å»ºé˜€é—¨æ§åˆ¶

```python
from ui.widgets.realtime_data import ValveControlWidget

valve_control = ValveControlWidget(["é˜€é—¨A", "é˜€é—¨B", "é˜€é—¨C"])
valve_control.set_valve_state(0, True)
valve_control.valve_clicked.connect(self.on_valve_clicked)
```

### åˆ›å»ºç§‘æŠ€é¢æ¿

```python
from ui.widgets.common import TechPanel

panel = TechPanel("å®æ—¶æ•°æ®")
layout = QVBoxLayout()
layout.addWidget(card)
panel.set_content_layout(layout)
```

## ğŸ¯ ä¸‹ä¸€æ­¥è®¡åˆ’

### é˜¶æ®µ 6: é¡µé¢ç»„ä»¶ï¼ˆé¢„è®¡ 2 å¤©ï¼‰

- [ ] åˆ›å»ºå®æ—¶æ•°æ®é¡µé¢ (`RealtimeDataPage`)
- [ ] åˆ›å»ºå†å²æ›²çº¿é¡µé¢ (`HistoryCurvePage`)
- [ ] åˆ›å»ºæŠ¥è­¦è®°å½•é¡µé¢ (`AlarmRecordPage`)
- [ ] åˆ›å»ºè®¾ç½®é¡µé¢ (`SettingsPage`)

### é˜¶æ®µ 7: å›¾è¡¨ç»„ä»¶ï¼ˆé¢„è®¡ 2 å¤©ï¼‰

- [ ] åˆ›å»ºç”µæç”µæµå›¾è¡¨ (`ElectrodeChart`)
- [ ] åˆ›å»ºå†å²æ›²çº¿å›¾è¡¨ (`HistoryChart`)
- [ ] åˆ›å»ºæŸ±çŠ¶å›¾ç»„ä»¶ (`BarChart`)

### é˜¶æ®µ 8: åå°çº¿ç¨‹é›†æˆï¼ˆé¢„è®¡ 2 å¤©ï¼‰

- [ ] é›†æˆ PLC æ•°æ®è½®è¯¢çº¿ç¨‹
- [ ] é›†æˆæŠ¥è­¦ç›‘æ§çº¿ç¨‹
- [ ] å®ç°æ•°æ®ç¼“å­˜æœºåˆ¶

## ğŸ“– ç›¸å…³æ–‡æ¡£

- `vdoc/CORE_COMPONENTS_GUIDE.md` - ç»„ä»¶ä½¿ç”¨æŒ‡å—
- `ui/styles/themes.py` - ä¸»é¢˜ç®¡ç†å™¨
- `ui/styles/colors.py` - é¢œè‰²å¸¸é‡
- `.cursor/rules/pyqt-frontend.mdc` - å‰ç«¯å¼€å‘è§„èŒƒ

## ğŸ‰ æ€»ç»“

æœ¬æ¬¡å¼€å‘å®Œæˆäº† **13 ä¸ªæ ¸å¿ƒ UI ç»„ä»¶**ï¼Œæ‰€æœ‰ç»„ä»¶éƒ½ï¼š

1. âœ… **æ”¯æŒä¸»é¢˜åˆ‡æ¢** - æ·±è‰²/æµ…è‰²ä¸»é¢˜è‡ªåŠ¨é€‚åº”
2. âœ… **ç¬¦åˆè®¾è®¡è§„èŒƒ** - éµå¾ªç§‘æŠ€é£æ ¼è®¾è®¡
3. âœ… **åŠŸèƒ½å®Œæ•´** - åŒ…å«æ‰€æœ‰å¿…è¦åŠŸèƒ½
4. âœ… **æ€§èƒ½ä¼˜ç§€** - ä¸é˜»å¡ä¸»çº¿ç¨‹
5. âœ… **æ˜“äºä½¿ç”¨** - æä¾›æ¸…æ™°çš„ API
6. âœ… **æ–‡æ¡£å®Œå–„** - è¯¦ç»†çš„ä½¿ç”¨æŒ‡å—

è¿™äº›ç»„ä»¶ä¸ºåç»­é¡µé¢å¼€å‘å¥ å®šäº†åšå®çš„åŸºç¡€ï¼ğŸš€

